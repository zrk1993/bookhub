(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["reader"],{1148:function(t,e,n){"use strict";var i=n("a691"),a=n("1d80");t.exports="".repeat||function(t){var e=String(a(this)),n="",o=i(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},"1310c":function(t,e,n){},"32a6":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("reader")},a=[],o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{ref:"reader",attrs:{id:"reader"}}),n("div",{on:{click:t.onClickEvent}},[n("Control",{ref:"Control",attrs:{readingProgress:t.readingProgress},on:{jumpCfi:t.jumpCfi,nextChapter:t.nextChapter,prevChapter:t.prevChapter,showCatalog:t.showCatalog}}),n("Catalog",{ref:"Catalog",on:{jump:t.jump}})],1)])},r=[],s=(n("c740"),n("96cf"),n("1da1")),c=n("5530"),l=n("b775");function d(t){return Object(l["a"])("/book/info",{method:"GET",params:Object(c["a"])({},t)})}function h(t){return Object(l["a"])("/reader/appearance",{method:"GET",params:Object(c["a"])({},t)})}var u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"control-box"},[n("div",{staticClass:"top-box flex align-items-center",class:{active:t.show},on:{click:function(t){t.stopPropagation(),t.preventDefault()}}},[n("div",{staticClass:"menu-item pl10",on:{click:t.onBack}},[n("van-icon",{attrs:{name:"arrow-left",size:"16"}})],1),n("div",{staticClass:"flex-1"})]),n("div",{staticClass:"foot-box",class:{active:t.show},on:{click:function(t){t.stopPropagation(),t.preventDefault()}}},[n("div",{staticClass:"btn-group"},[n("div",{on:{click:t.readBtnChapter}},[n("svg",{staticClass:"icon icon-catalog"},[n("svg",{attrs:{id:"icon-catalog",viewBox:"0 0 16 11",width:"100%",height:"100%"}},[n("g",[n("path",{attrs:{d:"M15.464 1a.5.5 0 0 0 0-1H4a.5.5 0 0 0 0 1h11.464zM15.464 6a.5.5 0 0 0 0-1H4a.5.5 0 0 0 0 1h11.464zM15.464 11a.5.5 0 0 0 0-1H4a.5.5 0 1 0 0 1h11.464zM1 1a.5.5 0 0 0 0-1H.5a.5.5 0 1 0 0 1H1zM1.135 6a.5.5 0 1 0 0-1H.5a.5.5 0 0 0 0 1h.635zM1.135 11a.5.5 0 1 0 0-1H.5a.5.5 0 1 0 0 1h.635z"}})])])]),n("h4",{staticClass:"read-opt-footer-h"},[t._v("目录")])]),n("div",{on:{click:t.readBtnProg}},[n("svg",{staticClass:"icon icon-progress"},[n("svg",{attrs:{id:"icon-progress",viewBox:"0 0 18 9",width:"100%",height:"100%"}},[n("g",[n("rect",{attrs:{y:"4",width:"3",height:"1",rx:".5"}}),n("rect",{attrs:{x:"14",y:"4",width:"4",height:"1",rx:".5"}}),n("path",{attrs:{d:"M13 4.5a4.5 4.5 0 1 0-9 0 4.5 4.5 0 0 0 9 0zm-8 0a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"}})])])]),n("h4",{staticClass:"read-opt-footer-h"},[t._v("进度")])]),n("div",{on:{click:t.readBtnSet}},[n("svg",{staticClass:"icon icon-font-set"},[n("svg",{attrs:{id:"icon-font-set",viewBox:"0 0 16 15",width:"100%",height:"100%"}},[n("g",[n("path",{attrs:{d:"M13.5 8c.942 0 1.5.465 1.5 1.5v5a.5.5 0 1 0 1 0v-1.938-.897V9.5C16 7.868 14.958 7 13.5 7c-1.369 0-2.5.754-2.5 2a.5.5 0 1 0 1 0c0-.588.619-1 1.5-1z"}}),n("path",{attrs:{d:"M10.495 12.5c0 1.203.748 1.951 1.93 2.12.97.138 2.19-.12 3.298-.673l-.446-.894c-.938.467-1.961.684-2.711.577-.716-.102-1.071-.458-1.071-1.13 0-1.148 1.727-1.945 3.907-1.51l.196-.98c-2.714-.542-5.103.56-5.103 2.49zM5.17 1.604a.546.546 0 0 1 .057-.134c-.036.045-.115.091-.23.09-.115 0-.19-.046-.224-.09a.54.54 0 0 1 .057.134l4.194 13.049a.5.5 0 0 0 .952-.306L5.782 1.298c-.315-.98-1.246-.988-1.564 0L.024 14.347a.5.5 0 0 0 .952.306L5.17 1.604z"}}),n("path",{attrs:{d:"M8 10V9H2v1z"}})])])]),n("h4",{staticClass:"read-opt-footer-h"},[t._v("设置")])]),n("div",{on:{click:t.readBtnMode}},[n("svg",{staticClass:"icon icon-day"},[n("svg",{attrs:{id:"icon-day",viewBox:"0 0 16 16",width:"100%",height:"100%"}},[n("g",[n("path",{attrs:{d:"M11.5 8a3.5 3.5 0 1 0-7 0 3.5 3.5 0 0 0 7 0zm-6 0a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zM7.5.506C7.5.226 7.732 0 8 0c.276 0 .5.23.5.506v1.488c0 .28-.232.506-.5.506-.276 0-.5-.23-.5-.506V.506zm0 13.5c0-.28.232-.506.5-.506.276 0 .5.23.5.506v1.488c0 .28-.232.506-.5.506-.276 0-.5-.23-.5-.506v-1.488zM2.347 3.054a.508.508 0 0 1-.004-.71.506.506 0 0 1 .711.003L4.107 3.4a.508.508 0 0 1 .004.71.506.506 0 0 1-.711-.003L2.347 3.054zm9.546 9.546a.508.508 0 0 1-.004-.71.506.506 0 0 1 .711.003l1.053 1.053a.508.508 0 0 1 .004.71.506.506 0 0 1-.711-.003L11.893 12.6zM15.494 7.5c.28 0 .506.232.506.5 0 .276-.23.5-.506.5h-1.488A.508.508 0 0 1 13.5 8c0-.276.23-.5.506-.5h1.488zm-13.5 0c.28 0 .506.232.506.5 0 .276-.23.5-.506.5H.506A.508.508 0 0 1 0 8c0-.276.23-.5.506-.5h1.488zM12.946 2.347a.508.508 0 0 1 .71-.004.506.506 0 0 1-.003.711L12.6 4.107a.508.508 0 0 1-.71.004.506.506 0 0 1 .003-.711l1.053-1.053zM3.4 11.893a.508.508 0 0 1 .71-.004.506.506 0 0 1-.003.711l-1.053 1.053a.508.508 0 0 1-.71.004.506.506 0 0 1 .003-.711L3.4 11.893z"}})])])]),n("h4",{staticClass:"read-opt-footer-h"},[t._v("夜间")])]),n("div",{on:{click:t.comment}},[n("svg",{staticClass:"icon icon-comment"},[n("svg",{attrs:{id:"icon-comment",viewBox:"0 0 16 12",width:"100%",height:"100%"}},[n("g",{attrs:{transform:"translate(-1)"}},[n("path",{attrs:{d:"M2 6c0-3.014 2.459-5 7-5s7 1.986 7 5c0 3.014-2.459 5-7 5H1.5l.354.854 1.706-1.707a.5.5 0 0 0-.028-.734C2.52 8.548 2 7.368 2 6zm.853 3.44l-1.707 1.706A.5.5 0 0 0 1.5 12H9c5.052 0 8-2.381 8-6s-2.948-6-8-6-8 2.381-8 6c0 1.654.643 3.114 1.882 4.173l-.029-.733z"}}),n("circle",{attrs:{cx:"5",cy:"6",r:"1"}}),n("circle",{attrs:{cx:"9",cy:"6",r:"1"}}),n("circle",{attrs:{cx:"13",cy:"6",r:"1"}})])])]),n("h4",{staticClass:"read-opt-footer-h"},[t._v("评论")])])])]),n("Theme",{ref:"Theme"}),n("ProgressBar",{ref:"ProgressBar",attrs:{readingProgress:t.readingProgress},on:{jumpCfi:t.jumpCfi,nextChapter:t.nextChapter,prevChapter:t.prevChapter}})],1):t._e()},f=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"theme-box"},[n("div",[n("div",{staticClass:"read-set-font"},[n("div",{staticClass:"read-font-down",attrs:{id:"readFontDown"}},[n("svg",{staticClass:"icon icon-size-down"},[n("svg",{attrs:{id:"icon-size-down",viewBox:"0 0 18 15",width:"100%",height:"100%"}},[n("g",[n("path",{attrs:{d:"M5.97.668h-.94l5 14a.5.5 0 0 0 .94-.336l-5-14a.5.5 0 0 0-.94 0l-5 14a.5.5 0 0 0 .94.336l5-14z"}}),n("path",{attrs:{d:"M9 10V9H2v1zM17.5 9a.5.5 0 1 0 0-1h-6a.5.5 0 1 0 0 1h6z"}})])])])]),n("div",{staticClass:"flex-1 slide"},[n("van-slider",{staticStyle:{width:"100%"},on:{change:t.onChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),n("div",{staticClass:"read-font-up",attrs:{id:"readFontUp"}},[n("svg",{staticClass:"icon icon-size-up"},[n("svg",{attrs:{id:"icon-size-up",viewBox:"0 0 18 15",width:"100%",height:"100%"}},[n("g",[n("path",{attrs:{d:"M5.97.668h-.94l5 14a.5.5 0 0 0 .94-.336l-5-14a.5.5 0 0 0-.94 0l-5 14a.5.5 0 0 0 .94.336l5-14z"}}),n("path",{attrs:{d:"M9 10V9H2v1zM17.5 9a.5.5 0 1 0 0-1h-6a.5.5 0 1 0 0 1h6z"}}),n("path",{attrs:{d:"M14 11.5a.5.5 0 1 0 1 0v-6a.5.5 0 1 0-1 0v6z"}})])])])])]),n("div",[n("div",{staticClass:"read-set-skin",attrs:{id:"readSetSkin"}},[n("div",{staticClass:"btn-group"},t._l(t.themes,(function(e,i){return n("div",{key:i,staticClass:"btn-group-cell",class:{active:e.code==t.theme},style:{"background-color":e.color},on:{click:function(n){return t.onTheme(e)}}},[n("svg",{staticClass:"icon icon-ok center"},[n("svg",{attrs:{id:"icon-ok",viewBox:"0 0 9 6",width:"100%",height:"100%"}},[n("path",{attrs:{d:"M2.646 5.854a.5.5 0 0 0 .708 0l5-5a.5.5 0 0 0-.708-.708l-5 5h.708l-2.5-2.5a.5.5 0 0 0-.708.708l2.5 2.5z"}})])])])})),0)])])])]):t._e()},v=[],g={data:function(){return{show:!1,value:0,theme:"default",themes:[{code:"default",color:"#c4b395"},{code:"blue",color:"#cad9e8"},{code:"green",color:"#d1edd1"},{code:"light",color:"#e6e6e6"}]}},methods:{open:function(){this.show=!0},close:function(){this.show=!1},onChange:function(){},onTheme:function(t){this.theme=t.code}}},m=g,C=(n("fd03"),n("2877")),w=Object(C["a"])(m,p,v,!1,null,"65146b60",null),x=w.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"progress-bar",on:{click:function(t){t.stopPropagation(),t.preventDefault()}}},[n("div",{staticClass:"flex align-items-center cfff"},[n("div",{staticClass:"flex align-items-center px10",on:{click:t.prevChapter}},[n("van-icon",{attrs:{name:"arrow-left",size:"16"}}),n("span",{staticClass:"fs16"},[t._v("上一章")])],1),n("div",{staticClass:"flex-1 flex flex-direction-column align-items-center"},[n("div",{staticClass:"fs18"},[t._v("第一张")]),n("div",{staticClass:"fs12 mt3"},[t._v(t._s(t.percentage)+"%")])]),n("div",{staticClass:"flex align-items-center px10",on:{click:t.nextChapter}},[n("span",{staticClass:"fs16"},[t._v("下一章")]),n("van-icon",{attrs:{name:"arrow",size:"16"}})],1)]),n("div",{staticClass:"slide"},[n("van-slider",{staticStyle:{width:"100%"},on:{change:t.onChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)]):t._e()},k=[],z=(n("b680"),{props:["readingProgress"],data:function(){return{show:!1,value:0}},computed:{percentage:function(){return this.readingProgress?(100*this.readingProgress.percentage).toFixed(2):"-"}},mounted:function(){this.value=1*this.percentage},methods:{open:function(){this.show=!0},close:function(){this.show=!1},nextChapter:function(){this.$emit("nextChapter")},prevChapter:function(){this.$emit("prevChapter")},onChange:function(){this.$emit("jumpCfi",this.value/100)}}}),y=z,_=(n("eec2"),Object(C["a"])(y,b,k,!1,null,"407d564a",null)),M=_.exports,j={props:["readingProgress"],components:{Theme:x,ProgressBar:M},data:function(){return{show:!1}},methods:{toggle:function(){this.show=~this.show},open:function(){this.show=!0},close:function(){this.show=!1},onBack:function(){this.$router.back()},readBtnChapter:function(){this.$emit("showCatalog")},jumpCfi:function(t){this.$emit("jumpCfi",t)},nextChapter:function(){this.$emit("nextChapter")},prevChapter:function(){this.$emit("prevChapter")},readBtnProg:function(){this.$refs.ProgressBar.open()},readBtnSet:function(){this.$refs.Theme.open()},readBtnMode:function(){},comment:function(){}}},P=j,$=(n("3889"),Object(C["a"])(P,u,f,!1,null,"8748f768",null)),B=$.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-popup",{attrs:{"get-container":"#app",position:"left"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{staticClass:"catalog-box flex flex-direction-column"},[n("div",[n("div",{staticClass:"tit fs14"},[t._v("目录")]),n("div",{staticClass:"flex align-items-center py10 px15"},[n("div",{staticClass:"fwb c333 fs14"},[t._v("共"+t._s(t.toc.length)+"章")]),n("div",{staticClass:"flex-1"}),n("div",{staticClass:"c333 fs12",on:{click:function(e){t.order=!t.order}}},[t._v(t._s(t.order?"倒序":"正序"))])]),n("div",{staticClass:"px15 py5 bg-a fs12"},[t._v(" 正文卷 ")])]),n("div",{staticClass:"flex-1 posr"},[n("div",{staticClass:"toc-wrap"},t._l(t.dataList,(function(e,i){return n("div",{key:i,staticClass:"toc-item",on:{click:function(n){return t.jump(e)}}},[n("div",{staticClass:"fs12"},[t._v(t._s(e.label))])])})),0)])])])],1)},I=[];function H(t){return null!=t&&"object"===typeof t&&!0===t["@@functional/placeholder"]}function L(t){return function e(n){return 0===arguments.length||H(n)?e:t.apply(this,arguments)}}function O(t){return"[object String]"===Object.prototype.toString.call(t)}var T=L((function(t){return O(t)?t.split("").reverse().join(""):Array.prototype.slice.call(t,0).reverse()})),S=T,F={data:function(){return{show:!1,toc:[],order:!0}},computed:{dataList:function(){return this.order?this.toc:S(this.toc)}},methods:{open:function(t){this.toc=t,this.show=!0},close:function(){this.show=!1},jump:function(t){this.$emit("jump",t),this.close()}}},A=F,D=(n("e629"),Object(C["a"])(A,E,I,!1,null,"54a65762",null)),R=D.exports,V={components:{Control:B,Catalog:R},data:function(){return{loading:!1,clickListen:null,loadingEpub:!1,bookInfo:null,appearanceInfo:null,rendition:null,toc:[],readingProgress:{percentage:"",cfi:"",href:""}}},mounted:function(){this.getData(),this.getAppearance()},methods:{onClickEvent:function(t){var e=document.body.clientWidth,n=document.body.clientHeight,i=Math.min(t.screenX,t.clientX),a=Math.min(t.screenY,t.clientY);a>n-60||a<60||(i>.35*e&&i<.65*e?this.$refs.Control.toggle():i>.5*document.body.clientWidth?(this.nextPage(),this.$refs.Control.close()):(this.prevPage(),this.$refs.Control.close()))},showCatalog:function(){this.$refs.Catalog.open(this.toc)},jump:function(t){this.rendition.display(t.href)},jumpCfi:function(t){this.rendition.display(t)},nextChapter:function(){var t=this;console.log(this.rendition);var e=this.toc.findIndex((function(e){return e.href===t.readingProgress.href})),n=this.toc[e+1];n&&this.rendition.display(n.ref)},prevChapter:function(){var t=this,e=this.toc.findIndex((function(e){return e.href===t.readingProgress.href})),n=this.toc[e-1];n&&this.rendition.display(n.ref)},nextPage:function(){this.rendition.next()},prevPage:function(){this.rendition.prev()},setTheme:function(){this.appearanceInfo&&this.rendition&&this.rendition.themes.default({body:{"font-size":this.appearanceInfo.fontSize,color:this.appearanceInfo.color,background:this.appearanceInfo.background}})},renderBook:function(){var t=this;this.loadingEpub=!0;var e=window.ePub(this.bookInfo.bookPath);this.loadingEpub=!1;var n=this.rendition=e.renderTo("reader",{width:"100%",height:document.documentElement.clientHeight,flow:"paginated"});this.setTheme(),this.jumpCfi(this.bookInfo.cfi),console.log(n),n.on("rendered",(function(e,n){var i=null,a=null;n.document.documentElement.addEventListener("mousedown",(function(t){i=t,a=Date.now()})),n.document.documentElement.addEventListener("mouseup",(function(e){Math.abs(i.clientX-e.clientX)<5&&Date.now()-a<600&&t.onClickEvent(e)})),n.document.documentElement.addEventListener("touchend",(function(t){}))})),n.on("relocated",(function(e){t.readingProgress.percentage=e.start.percentage,t.readingProgress.cfi=e.start.cfi,t.readingProgress.href=e.start.href,console.log(e)})),e.ready.then((function(){var t=e.locations.generate(1600);return t})),e.loaded.navigation.then((function(e){t.toc=e.toc,console.log(e.toc)}))},getData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,d();case 4:n=e.sent,i=n.code,a=n.data,o=n.message,0===i?(t.bookInfo=a,t.renderBook()):t.$notify({type:"warning",message:o}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),console.log(e.t0),t.$notify({type:"danger",message:e.t0.message});case 15:return e.prev=15,t.loading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})))()},getAppearance:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h();case 3:n=e.sent,i=n.code,a=n.data,o=n.message,0===i?(t.appearanceInfo=a,t.setTheme()):t.$notify({type:"warning",message:o}),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0),t.$notify({type:"danger",message:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()}}},N=V,X=(n("7940"),Object(C["a"])(N,o,r,!1,null,"03b37eac",null)),W=X.exports,G={components:{Reader:W},data:function(){return{loading:!1}},mounted:function(){},methods:{}},J=G,Y=Object(C["a"])(J,i,a,!1,null,"6f6198ea",null);e["default"]=Y.exports},3889:function(t,e,n){"use strict";n("d4de")},"3ee8":function(t,e,n){},"408a":function(t,e,n){var i=n("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=i(t))throw TypeError("Incorrect invocation");return+t}},"718e":function(t,e,n){},7940:function(t,e,n){"use strict";n("3ee8")},9140:function(t,e,n){},b680:function(t,e,n){"use strict";var i=n("23e7"),a=n("a691"),o=n("408a"),r=n("1148"),s=n("d039"),c=1..toFixed,l=Math.floor,d=function(t,e,n){return 0===e?n:e%2===1?d(t,e-1,n*t):d(t*t,e/2,n)},h=function(t){var e=0,n=t;while(n>=4096)e+=12,n/=4096;while(n>=2)e+=1,n/=2;return e},u=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));i({target:"Number",proto:!0,forced:u},{toFixed:function(t){var e,n,i,s,c=o(this),u=a(t),f=[0,0,0,0,0,0],p="",v="0",g=function(t,e){var n=-1,i=e;while(++n<6)i+=t*f[n],f[n]=i%1e7,i=l(i/1e7)},m=function(t){var e=6,n=0;while(--e>=0)n+=f[e],f[e]=l(n/t),n=n%t*1e7},C=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==f[t]){var n=String(f[t]);e=""===e?n:e+r.call("0",7-n.length)+n}return e};if(u<0||u>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(e=h(c*d(2,69,1))-69,n=e<0?c*d(2,-e,1):c/d(2,e,1),n*=4503599627370496,e=52-e,e>0){g(0,n),i=u;while(i>=7)g(1e7,0),i-=7;g(d(10,i,1),0),i=e-1;while(i>=23)m(1<<23),i-=23;m(1<<i),g(1,1),m(2),v=C()}else g(0,n),g(1<<-e,0),v=C()+r.call("0",u);return u>0?(s=v.length,v=p+(s<=u?"0."+r.call("0",u-s)+v:v.slice(0,s-u)+"."+v.slice(s-u))):v=p+v,v}})},c740:function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").findIndex,o=n("44d2"),r=n("ae40"),s="findIndex",c=!0,l=r(s);s in[]&&Array(1)[s]((function(){c=!1})),i({target:"Array",proto:!0,forced:c||!l},{findIndex:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),o(s)},d4de:function(t,e,n){},e629:function(t,e,n){"use strict";n("1310c")},eec2:function(t,e,n){"use strict";n("718e")},fd03:function(t,e,n){"use strict";n("9140")}}]);